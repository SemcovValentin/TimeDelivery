<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Offcanvas Auth</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<style>
  /* Общие стили для форм */
  .offcanvas {
    background-color: #222;
    color: #888;
    border-left: 1px solid #444;
  }
  .auth-form {
    max-width: 400px;
    margin: 2rem auto;
    padding: 2rem;
    background: #2a2a2a;
    border-radius: 1rem;
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.2);
    color: #999;
    border: 1px solid #444;
  }
  .auth-switcher .btn-group {
    box-shadow: 0 0.125rem 0.5rem rgba(0,0,0,0.2);
    border-radius: 0.75rem;
    overflow: hidden;
  }
  .auth-switcher .btn {
    border: none;
    font-weight: 500;
    transition: all 0.2s ease;
  }
  .auth-switcher .btn:not(.active) {
    background: #333;
    color: #f8f9fa;
  }
  .auth-switcher .btn.active {
    background: #0d6efd;
    color: #fff;
  }
  .form-control {
    background: #333;
    border: 1px solid #444;
    color: #f8f9fa;
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
  }
  .form-control:focus {
    background: #444;
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.2rem rgba(13,110,253,0.25);
    color: #fff;
  }
  .form-control::placeholder {
    color: #eee; /* почти белый */
    opacity: 1;
  }
  .btn-primary {
    background: #0d6efd;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 0.2s ease;
  }
  .btn-primary:hover {
    background: #0b5ed7;
    transform: translateY(-1px);
  }
  .form-group label {
    font-weight: 500;
    margin-bottom: 0.5rem;
    color: #f8f9fa;
  }
  .text-danger {
    font-size: 0.875rem;
    color: #ff6b6b;
  }
  .toast {
    border-radius: 0.75rem;
  }
  .toast-header {
    border-radius: 0.75rem 0.75rem 0 0;
  }
  .input-group-text {
    background: #444;
    color: #888;
    border: 1px solid #555;
  }
  @media (max-width: 576px) {
    .auth-form {
      padding: 1.5rem;
    }
  }
  .toast {
    border-radius: 0.75rem;
    background: #2a2a2a;
    border: 1px solid #444;
    color: #eee;
  }
  .toast-header {
    border-radius: 0.75rem 0.75rem 0 0;
    background: #333;
    color: #eee;
    border-bottom: 1px solid #444;
  }
  .toast-body {
    background: #2a2a2a;
    color: #888;
  }

</style>

<body class="p-4">

<button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
  Вход
</button>

<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasRightLabel">Авторизация</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Закрыть"></button>
  </div>
  <div class="offcanvas-body">
    <div class="auth-switcher mb-4">
      <div class="btn-group w-100">
        <button type="button" class="btn btn-primary active" id="loginTab">Вход</button>
        <button type="button" class="btn btn-outline-primary" id="registerTab">Регистрация</button>
      </div>
    </div>

    <!-- Форма входа -->
    <form id="loginForm" class="auth-form">
      <div class="form-group mb-3">
        <label for="loginPhone">Номер телефона:</label>
        <input type="text" class="form-control" id="loginPhone" placeholder="+7 (XXX) XXX-XX-XX" required>
      </div>
      <div class="form-group mb-4">
        <label for="loginPassword">Пароль:</label>
        <input type="password" class="form-control" id="loginPassword" placeholder="Введите пароль" minlength="6" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">Войти</button>
    </form>

    <!-- Форма регистрации -->
    <form id="registerForm" class="auth-form d-none">
      <div class="form-group mb-3">
        <label for="registerName">Имя:</label>
        <input type="text" class="form-control" id="registerName" placeholder="Введите ваше имя" required>
      </div>
      <div class="form-group mb-3">
        <label for="registerEmail">Email:</label>
        <input type="email" class="form-control" id="registerEmail" placeholder="Введите ваш email" required>
      </div>
      <div class="form-group mb-3">
        <label for="registerPhone">Номер телефона:</label>
        <input type="text" class="form-control" id="registerPhone" placeholder="+7 (XXX) XXX-XX-XX" required>
      </div>
      <div class="form-group mb-3">
        <label for="registerPassword">Пароль:</label>
        <input type="password" class="form-control" id="registerPassword" placeholder="Введите пароль" minlength="6" required>
      </div>
      <div class="form-group mb-4">
        <label for="registerConfirm">Повторите пароль:</label>
        <input type="password" class="form-control" id="registerConfirm" placeholder="Повторите пароль" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">Зарегистрироваться</button>
    </form>
  </div>
</div>

<div class="toast-container position-fixed top-0 end-0 p-3">
  <div id="universalToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <strong class="me-auto toast-title">Успех</strong>
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Закрыть"></button>
    </div>
    <div class="toast-body">
      Сообщение успешно отправлено!
    </div>
  </div>
</div>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>

  // Функция показа Toast
  function showUniversalToast(title, message, type = 'success') {
    const toastEl = document.getElementById('universalToast');
    const toastTitle = toastEl.querySelector('.toast-title');
    const toastBody = toastEl.querySelector('.toast-body');
    const toastHeader = toastEl.querySelector('.toast-header');

    toastEl.classList.remove('bg-success', 'bg-info', 'bg-warning', 'bg-danger');
    toastHeader.classList.remove('bg-success', 'bg-info', 'bg-warning', 'bg-danger');
    toastEl.classList.add('bg-' + type);
    toastHeader.classList.add('bg-' + type);

    toastTitle.textContent = title;
    toastBody.textContent = message;
    const toast = new bootstrap.Toast(toastEl);
    toast.show();

    setTimeout(() => toast.hide(), 5000);
  }

  document.addEventListener("DOMContentLoaded", function () {
    // Элементы управления
    const loginTab = document.getElementById('loginTab');
    const registerTab = document.getElementById('registerTab');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');

    // Переключение между формами
    function switchForm(formToShow) {
      loginForm.classList.toggle('d-none', formToShow !== 'login');
      registerForm.classList.toggle('d-none', formToShow !== 'register');
      loginTab.classList.toggle('active', formToShow === 'login');
      registerTab.classList.toggle('active', formToShow === 'register');
      loginTab.classList.toggle('btn-primary', formToShow === 'login');
      loginTab.classList.toggle('btn-outline-primary', formToShow !== 'login');
      registerTab.classList.toggle('btn-primary', formToShow === 'register');
      registerTab.classList.toggle('btn-outline-primary', formToShow !== 'register');
      if (formToShow === 'login') {
        document.getElementById('loginPhone').value = '';
      }
    }

    loginTab.addEventListener('click', () => switchForm('login'));
    registerTab.addEventListener('click', () => switchForm('register'));

    // Маска для номеров телефона
    function initPhoneMask(inputId) {
      const input = document.getElementById(inputId);
      input.addEventListener('focus', () => {
        if (!input.value) input.value = '+7 (';
      });
      input.addEventListener('input', (e) => {
        let val = e.target.value.replace(/\D/g, '').substring(1);
        if (val.length > 10) val = val.substring(0, 10);
        e.target.value = `+7 (${val.substring(0,3)}) ${val.substring(3,6)}-${val.substring(6,8)}-${val.substring(8,10)}`;
      });
    }

    initPhoneMask('loginPhone');
    initPhoneMask('registerPhone');

    // Валидация формы регистрации
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const password = document.getElementById('registerPassword').value;
      const confirm = document.getElementById('registerConfirm').value;
      const email = document.getElementById('registerEmail').value;

      if (password !== confirm) {
        alert('Пароли не совпадают!');
        return;
      }

      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert('Введите корректный email!');
        return;
      }

      showUniversalToast('Регистрация', 'Вы успешно зарегистрировались!', 'success');
      this.reset();
      switchForm('login');
    });

    // Валидация формы входа
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      showUniversalToast('Успешный вход', 'Вы успешно вошли в систему!', 'success');
    });
  });
</script>
</body>
</html>
